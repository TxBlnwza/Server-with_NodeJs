{"ast":null,"code":"var _jsxFileName = \"D:\\\\Server-with_NodeJs\\\\fontend\\\\src\\\\pages\\\\Viewlogs.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ViewLogs = () => {\n  _s();\n  const [logs, setLogs] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const droneId = parseInt(process.env.REACT_APP_DRONE_ID);\n  useEffect(() => {\n    const fetchLogs = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        let allLogs = [];\n        let currentPage = 1;\n        let hasMoreData = true;\n        while (hasMoreData && currentPage <= 3) {\n          var _response$data, _response$data$items;\n          const response = await axios.get(`https://app-tracking.pockethost.io/api/collections/drone_logs/records?page=${currentPage}`, {\n            headers: {\n              'Authorization': 'Bearer 20250301efx'\n            }\n          });\n          if (((_response$data = response.data) === null || _response$data === void 0 ? void 0 : (_response$data$items = _response$data.items) === null || _response$data$items === void 0 ? void 0 : _response$data$items.length) > 0) {\n            const filteredLogs = response.data.items.filter(log => log.drone_id === droneId);\n            allLogs = [...allLogs, ...filteredLogs];\n            currentPage++;\n          } else {\n            hasMoreData = false;\n          }\n        }\n        const sortedLogs = allLogs.sort((a, b) => new Date(b.created) - new Date(a.created)).slice(0, 25);\n        setLogs(sortedLogs);\n      } catch (err) {\n        var _err$response, _err$response2, _err$response3, _err$response3$data;\n        console.error('Error details:', {\n          message: err.message,\n          response: (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data,\n          status: (_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.status\n        });\n        setError(`เกิดข้อผิดพลาด: ${((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.message) || 'Server Error'}`);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchLogs();\n  }, [droneId]);\n  const formatDate = dateString => {\n    try {\n      return new Date(dateString).toLocaleString('th-TH');\n    } catch {\n      return dateString;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mt-4\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 5\n  }, this);\n};\n_s(ViewLogs, \"7cUBf/5kxDf7xSVzqIv9oFmaTIo=\");\n_c = ViewLogs;\nexport default ViewLogs;\nvar _c;\n$RefreshReg$(_c, \"ViewLogs\");","map":{"version":3,"names":["React","useState","useEffect","axios","Link","jsxDEV","_jsxDEV","ViewLogs","_s","logs","setLogs","loading","setLoading","error","setError","droneId","parseInt","process","env","REACT_APP_DRONE_ID","fetchLogs","allLogs","currentPage","hasMoreData","_response$data","_response$data$items","response","get","headers","data","items","length","filteredLogs","filter","log","drone_id","sortedLogs","sort","a","b","Date","created","slice","err","_err$response","_err$response2","_err$response3","_err$response3$data","console","message","status","formatDate","dateString","toLocaleString","className","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/Server-with_NodeJs/fontend/src/pages/Viewlogs.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { Link } from 'react-router-dom';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\n\r\nconst ViewLogs = () => {\r\n  const [logs, setLogs] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  const droneId = parseInt(process.env.REACT_APP_DRONE_ID);\r\n\r\n  useEffect(() => {\r\n    const fetchLogs = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setError(null);\r\n        \r\n        let allLogs = [];\r\n        let currentPage = 1;\r\n        let hasMoreData = true;\r\n\r\n        while (hasMoreData && currentPage <= 3) {\r\n          const response = await axios.get(\r\n            `https://app-tracking.pockethost.io/api/collections/drone_logs/records?page=${currentPage}`,\r\n            {\r\n              headers: {\r\n                'Authorization': 'Bearer 20250301efx'\r\n              }\r\n            }\r\n          );\r\n\r\n          if (response.data?.items?.length > 0) {\r\n            const filteredLogs = response.data.items.filter(log => log.drone_id === droneId);\r\n            allLogs = [...allLogs, ...filteredLogs];\r\n            currentPage++;\r\n          } else {\r\n            hasMoreData = false;\r\n          }\r\n        }\r\n\r\n        const sortedLogs = allLogs\r\n          .sort((a, b) => new Date(b.created) - new Date(a.created))\r\n          .slice(0, 25);\r\n\r\n        setLogs(sortedLogs);\r\n      } catch (err) {\r\n        console.error('Error details:', {\r\n          message: err.message,\r\n          response: err.response?.data,\r\n          status: err.response?.status\r\n        });\r\n        setError(`เกิดข้อผิดพลาด: ${err.response?.data?.message || 'Server Error'}`);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchLogs();\r\n  }, [droneId]);\r\n\r\n  const formatDate = (dateString) => {\r\n    try {\r\n      return new Date(dateString).toLocaleString('th-TH');\r\n    } catch {\r\n      return dateString;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mt-4\">\r\n      {/* ... ส่วนแสดงผลเหมือนเดิม ... */}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ViewLogs;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}